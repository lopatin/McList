// Generated by CoffeeScript 1.4.0
(function() {
  var mc;

  mc = McList;

  mc.Commander = {
    shift_mode: false,
    control_mode: false,
    alt_mode: false,
    key_queue: [],
    init: function() {
      var self;
      this.init_special_modes('keydown', true);
      this.init_special_modes('keyup', false);
      self = this;
      return $(document).bind('keydown', function(e) {
        var keyval;
        e.preventDefault();
        keyval = mc.KeyCodeHelper.get_key_value(e);
        return self.keystroke(keyval);
      });
    },
    init_special_modes: function(event, value) {
      return $(document).bind(event, function(e) {
        switch (e.keyCode) {
          case 16:
            return mc.Commander.shift_mode = value;
          case 17:
            return mc.Commander.control_mode = value;
          case 18:
            return mc.Commander.alt_mode = value;
        }
      });
    },
    keystroke: function(key) {
      if (key) {
        this.key_queue.push(key);
      }
      this.analyze_queue();
      return console.log(this.key_queue);
    },
    analyze_queue: function() {
      var charmap, self, task;
      self = this;
      task = mc.app.list.root_task;
      charmap = matches.pattern({
        "[..., 'escape']": function() {
          if (!mc.app.list.command_mode) {
            mc.app.list.toggle_command_mode();
            return self.key_queue = [];
          }
        },
        "[..., c]": function(c) {
          if (mc.app.list.command_mode) {
            switch (c) {
              case 'i':
                mc.app.list.toggle_command_mode();
                break;
              case 'l':
                mc.app.list.cursor.move_right();
                break;
              case 'h':
                mc.app.list.cursor.move_left();
                break;
              case '$':
                mc.app.list.cursor.move_to_last();
                break;
              case '0':
                mc.app.list.cursor.move_to_first();
                break;
              case 'x':
                task.char_list.deleteChar();
                mc.app.list.cursor.move_right();
            }
          } else {
            switch (c) {
              case 'backspace':
                task.char_list.deleteChar();
                break;
              case 'return':
                break;
              default:
                task.char_list.addChar(c);
            }
          }
          task.render();
          mc.app.list.blink_in_second();
          return self.key_queue = [];
        }
      });
      return charmap(this.key_queue);
    }
  };

}).call(this);
